---
layout: default
menu: submit.blog
---

<!--THIS ACTUALLY CREATES SUBMISSION-->


<div class="container">
	<input type="text" class="form-control" id="submitSighting" placeholder="Enter submission picture">
	<button class="btn btn-primary" id="submitBtn">Submit</button>
</div>

<script src="https://cdn.jsdelivr.net/gh/ethereum/web3.js/dist/web3.min.js"></script>
<script src="http://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<script>
  const web3 = new Web3();
  const _web3 = new Web3(web3.currentProvider || new Web3.providers.HttpProvider("http://localhost:8545"));
  $(document).ready(function () {
    // create and deploy contract
    document.getElementById("submitBtn").addEventListener("click", function (e) {
      e.preventDefault();

      let sightingValue = document.getElementById("submitSighting").value;
      console.log(sightingValue)
      const abi = [
        {
          "constant": true,
          "inputs": [],
          "name": "founder",
          "outputs": [
            {
              "name": "",
              "type": "address"
            }
          ],
          "payable": false,
          "stateMutability": "view",
          "type": "function"
        },
        {
          "inputs": [
            {
              "name": "_questionLink",
              "type": "string"
            },
            {
              "name": "_modelHash",
              "type": "string"
            },
            {
              "name": "_photoHash",
              "type": "string"
            },
            {
              "name": "_expectedHashValue",
              "type": "string"
            }
          ],
          "payable": true,
          "stateMutability": "payable",
          "type": "constructor"
        },
        {
          "anonymous": false,
          "inputs": [
            {
              "indexed": true,
              "name": "_from",
              "type": "address"
            },
            {
              "indexed": false,
              "name": "_attempt",
              "type": "string"
            }
          ],
          "name": "Sighting",
          "type": "event"
        },
        {
          "constant": true,
          "inputs": [],
          "name": "getmodelHash",
          "outputs": [
            {
              "name": "",
              "type": "string"
            }
          ],
          "payable": false,
          "stateMutability": "view",
          "type": "function"
        },
        {
          "constant": true,
          "inputs": [],
          "name": "getphotoHash",
          "outputs": [
            {
              "name": "",
              "type": "string"
            }
          ],
          "payable": false,
          "stateMutability": "view",
          "type": "function"
        },
        {
          "constant": true,
          "inputs": [],
          "name": "getexpectedHashValue",
          "outputs": [
            {
              "name": "",
              "type": "string"
            }
          ],
          "payable": false,
          "stateMutability": "view",
          "type": "function"
        },
        {
          "constant": false,
          "inputs": [
            {
              "name": "referralCodeAlsoParentAddr",
              "type": "address"
            }
          ],
          "name": "registerNode",
          "outputs": [],
          "payable": false,
          "stateMutability": "nonpayable",
          "type": "function"
        },
        {
          "constant": false,
          "inputs": [],
          "name": "payIn",
          "outputs": [],
          "payable": true,
          "stateMutability": "payable",
          "type": "function"
        },
        {
          "constant": true,
          "inputs": [],
          "name": "getReward",
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ],
          "payable": false,
          "stateMutability": "view",
          "type": "function"
        },
        {
          "constant": false,
          "inputs": [
            {
              "name": "attempt",
              "type": "string"
            }
          ],
          "name": "attemptAnswer",
          "outputs": [],
          "payable": false,
          "stateMutability": "nonpayable",
          "type": "function"
        },
        {
          "constant": true,
          "inputs": [
            {
              "name": "index",
              "type": "uint256"
            }
          ],
          "name": "viewAnswerMapAddress",
          "outputs": [
            {
              "name": "",
              "type": "address"
            }
          ],
          "payable": false,
          "stateMutability": "view",
          "type": "function"
        },
        {
          "constant": true,
          "inputs": [
            {
              "name": "index",
              "type": "uint256"
            }
          ],
          "name": "viewAnswerMapAnswer",
          "outputs": [
            {
              "name": "",
              "type": "string"
            }
          ],
          "payable": false,
          "stateMutability": "view",
          "type": "function"
        },
        {
          "constant": true,
          "inputs": [],
          "name": "viewNumTotalNodes",
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ],
          "payable": false,
          "stateMutability": "view",
          "type": "function"
        },
        {
          "constant": true,
          "inputs": [],
          "name": "getNumNodesPayed",
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ],
          "payable": false,
          "stateMutability": "view",
          "type": "function"
        },
        {
          "constant": true,
          "inputs": [],
          "name": "getQuestionLink",
          "outputs": [
            {
              "name": "",
              "type": "string"
            }
          ],
          "payable": false,
          "stateMutability": "view",
          "type": "function"
        },
        {
          "constant": true,
          "inputs": [],
          "name": "getNextPayeeAddress",
          "outputs": [
            {
              "name": "",
              "type": "address"
            }
          ],
          "payable": false,
          "stateMutability": "view",
          "type": "function"
        },
        {
          "constant": true,
          "inputs": [],
          "name": "getContractOwner",
          "outputs": [
            {
              "name": "",
              "type": "address"
            }
          ],
          "payable": false,
          "stateMutability": "view",
          "type": "function"
        },
        {
          "constant": true,
          "inputs": [],
          "name": "getNextPayeeIndex",
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ],
          "payable": false,
          "stateMutability": "view",
          "type": "function"
        },
        {
          "constant": false,
          "inputs": [
            {
              "name": "addr",
              "type": "address"
            }
          ],
          "name": "payOut",
          "outputs": [],
          "payable": false,
          "stateMutability": "nonpayable",
          "type": "function"
        }
      ];
      const Contract = _web3.eth.contract(abi);
      const contractInstance = Contract.at('0xe78a0f7e598cc8b0bb87894b0f60dd2a88d6a8ab');

      contractInstance.attemptAnswer.sendTransaction(
        'this_is_my_attempt_SOME_IPFS_URL',
        { from: _web3.eth.accounts[1], gas: 3000000 },  // person is being referred
        (error, result) => {
          console.log('attempt answer', result);
          const newSighting = `
						<tr>
						<td class="text-center"><i class="flag flag-us"></i></td>
						<td class="text-center">San Francisco</td>
						<td>
							<div class="clearfix">
								<div class="float-left">
									<strong>93</strong>
								</div>
								<div class="float-right">
									<small class="text-muted">
										&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
										&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
										&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
									</small>
								</div>
							</div>
							<div class="progress progress-xs">
								<div class="progress-bar bg-green" role="progressbar"
									 style="width: 93%"
									 aria-valuenow="93" aria-valuemin="0" aria-valuemax="100">
								</div>
							</div>
						</td>
						<td>
							<div class="small text-muted">Sighted</div>
							<div>1 second ago</div>
						</td>
						<td class="text-center">
							<button type="button" class="btn btn-outline-primary"><i class="fe fe-camera"></i></button>
						</td>
						<td class="text-center">
							<button type="button" class="btn btn-outline-success"><i class="fe fe-check mr-2"></i>Connect</button>
						</td>
						<td class="text-center">
							<button type="button" class="btn btn-icon btn-outline-danger"><i class="fe fe-eye-off"></i></button>
						</td>
						</tr>
					  	`;
          $(newSighting).prependTo('.datatable_users')
        }
      )

    });
  });
</script>
